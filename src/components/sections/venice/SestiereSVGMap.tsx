import { useState } from 'react';
import { cn } from '@/lib/utils';

interface SestiereSVGMapProps {
  activeSestiere: number;
  onSelect: (index: number) => void;
}

/* Colors: Mediterranean palette with HSL inline values */
const sestiereColors = [
  { fill: 'hsl(210 85% 35%)', name: 'San Marco' },      // Primary blue
  { fill: 'hsl(15 60% 55%)', name: 'Dorsoduro' },        // Warm terracotta
  { fill: 'hsl(150 30% 50%)', name: 'San Polo' },        // Sage green
  { fill: 'hsl(350 40% 60%)', name: 'Cannaregio' },      // Dusty rose
  { fill: 'hsl(45 50% 55%)', name: 'Castello' },         // Muted gold
  { fill: 'hsl(270 30% 60%)', name: 'Santa Croce' },     // Soft lavender
];

/* Geographically accurate paths traced from Wikimedia Commons "Sestieri di Venezia" SVG */
const sestiereData = [
  {
    // San Marco — central, south of Grand Canal
    paths: [
      'M 231.92561,114.17826 C 232.02132,114.26506 225.18016,124.52887 225.16403,124.5162 C 224.99462,124.38321 210.43495,133.16186 210.43495,133.16186 L 191.29155,140.27486 L 182.24775,144.89383 L 177.78458,148.82486 L 176.89889,152.81462 L 178.32268,159.19177 L 178.49169,163.36013 L 181.30095,168.04741 L 187.42884,172.92884 L 199.21595,175.4001 L 216.72823,175.77282 L 230.16326,171.17662 L 242.89118,165.51977 L 255.79226,158.83556 L 252.86535,150.76007 L 252.86039,145.15311 L 250.88347,141.69225 L 247.47746,135.891 L 244.08633,133.49576 L 235.94963,134.3423 L 234.11711,128.3319 L 240.31471,115.98167 L 236.0353,115.13165 L 231.92561,114.17826 z',
      // San Giorgio Maggiore island
      'M 272.76172,211.67827 L 266.87974,198.92077 L 268.60678,194.08005 C 269.67991,191.07227 270.89101,189.12978 271.80526,188.95 C 272.61453,188.79088 277.61219,190.6782 282.91117,193.14405 L 292.54569,197.62743 L 291.2409,200.65214 C 290.52326,202.31572 288.78637,207.94538 287.38111,213.16248 C 285.18863,221.30228 284.54935,222.71759 282.87542,223.13772 C 281.80253,223.407 280.41149,223.80922 279.78423,224.03155 C 279.0027,224.30854 276.79247,220.42054 272.76174,211.67828 L 272.76172,211.67827 z',
    ],
    label: { x: 218, y: 158 },
  },
  {
    // Dorsoduro — south/southwest, including Giudecca
    paths: [
      'M 235.42649,180.54859 L 226.03616,188.75712 L 217.27973,197.69279 L 208.24295,201.22866 L 202.61498,202.42524 L 191.5629,200.33347 L 183.04841,197.21944 C 183.04958,197.2089 157.34438,188.67734 157.3503,188.66587 L 150.64689,186.00683 L 136.71388,182.01598 L 128.71739,181.05183 C 128.77849,181.03665 122.27826,178.46479 122.30143,178.55987 L 120.08006,179.95979 L 103.64989,177.17384 L 89.614397,177.73471 L 82.384932,178.51315 L 81.340972,179.83435 L 77.816457,178.16979 L 69.226884,173.25836 L 69.645148,171.9676 L 95.737436,127.33234 L 97.376964,130.45209 L 99.552275,137.31939 L 100.64893,140.12982 L 102.17693,144.66012 L 108.54089,144.66012 L 112.07642,141.47814 L 113.49064,137.9426 L 125.1579,135.46773 L 126.92567,131.9322 L 127.98633,130.51798 L 127.27922,125.21468 L 133.28963,124.15402 L 135.0574,126.6289 L 138.94648,128.39666 L 142.48202,132.6393 L 146.3711,134.05352 L 146.37606,139.71533 L 149.91159,138.79906 L 160.2793,146.28845 L 173.17892,147.9429 L 173.81135,155.92032 L 174.80407,162.41986 L 176.48943,165.96524 L 178.78014,169.36519 L 181.86035,172.03408 L 185.07681,174.58183 L 189.04404,176.78589 L 196.74507,179.2798 L 207.20166,180.1901 L 222.80985,178.95513 L 234.59759,179.09564 L 235.42649,180.54859 z',
      // Giudecca
      'M 192.44338,245.98586 C 189.40726,245.36815 184.05689,244.71052 180.55368,244.52446 C 177.05046,244.33838 171.12684,243.73918 167.39007,243.19285 C 162.62095,242.49562 159.4646,242.45595 156.80011,243.05985 C 153.15469,243.88607 152.5993,243.72568 142.78724,239.0137 C 137.16785,236.31515 130.21643,232.57599 127.33957,230.70446 C 124.46274,228.83295 120.90066,226.8012 119.4239,226.18951 C 117.11265,225.23216 116.81524,224.77005 117.28745,222.86974 C 117.97708,220.09444 124.24829,204.08538 125.27105,202.48931 C 125.88368,201.53323 128.85195,202.63843 140.49936,208.15924 C 167.74561,221.07385 201.6344,230.16169 213.89318,227.84102 C 228.2641,225.1205 237.53155,221.14365 253.43423,210.87317 L 262.50772,205.0132 L 262.76575,210.27722 C 262.92874,213.60241 262.35828,218.23451 261.21693,222.85366 C 259.41675,230.13919 259.38456,230.19119 252.46626,236.98903 C 247.60978,241.76098 244.37362,244.2096 241.70074,245.13476 C 236.36648,246.98108 200.3905,247.60271 192.44338,245.98586 L 192.44338,245.98586 z',
      // Small Dorsoduro island
      'M 79.568774,228.59071 C 77.657707,227.18529 76.094118,225.87193 76.094118,225.67212 C 76.094118,224.50273 87.604083,202.50865 89.023867,200.96501 C 91.421757,198.3579 98.145947,197.6926 108.80585,199.00774 L 117.51598,200.08234 L 113.62515,211.2215 L 109.73431,222.36066 L 99.496014,226.30738 C 85.740066,231.61009 83.95295,231.81486 79.568757,228.59069 L 79.568774,228.59071 z',
      // Tiny south island
      'M 62.200572,220.56178 L 56.375049,217.57251 L 58.378881,215.42944 C 60.267875,213.4092 75.816434,205.23149 76.479803,205.90933 C 77.073524,206.51603 69.71653,223.61462 68.875368,223.58297 C 68.408272,223.56539 65.404618,222.20586 62.200572,220.56177 L 62.200572,220.56178 z',
    ],
    label: { x: 155, y: 185 },
  },
  {
    // San Polo — center-north
    paths: [
      'M 195.90814,86.76343 L 183.00617,104.49943 L 179.47064,104.70363 L 174.65537,108.59767 L 170.20357,109.45909 L 163.06775,109.66825 L 161.9823,111.30153 L 155.91705,111.99872 L 149.90664,110.01189 L 146.72466,112.48676 L 143.0596,118.00913 L 144.88717,123.38215 L 148.13392,123.73075 L 152.1674,127.90862 L 153.44712,129.24321 L 155.27471,130.16938 L 153.8704,134.62118 L 149.71235,138.63484 L 160.37413,146.42822 L 167.53103,146.88169 L 173.39414,147.49384 L 173.9046,146.15574 L 183.07762,139.53573 L 186.69064,137.74367 L 197.43281,133.5158 L 208.24295,128.75022 L 215.19288,126.64334 L 219.72604,124.09559 L 223.92502,120.44385 L 227.53334,117.03354 L 228.45501,112.46998 L 222.98231,104.58103 L 217.40656,100.7325 L 211.65093,98.332848 L 207.9705,96.026084 L 199.76322,88.862127 L 195.90814,86.76343 z',
    ],
    label: { x: 185, y: 120 },
  },
  {
    // Cannaregio — north
    paths: [
      'M 231.9912,113.95901 L 229.86949,105.54167 L 226.07039,101.67058 L 216.27279,95.240727 L 209.50129,89.613772 L 200.15911,83.381595 L 192.82448,79.846061 L 186.20275,78.545635 L 179.33546,78.156088 L 172.1805,77.838528 L 168.18343,79.162758 L 158.67349,83.033848 L 146.92843,89.427708 L 144.16561,91.069785 L 134.3561,104.00729 L 130.23333,109.31059 L 127.65048,107.11148 L 119.75272,92.280516 L 111.96873,84.604227 L 104.21583,80.639158 L 103.88873,74.612435 L 103.21845,70.629659 L 102.27096,63.742974 L 104.98707,62.666209 L 110.30866,60.160859 L 109.94291,55.00734 L 118.20004,45.26401 L 121.4125,41.584212 L 125.26559,33.164823 L 141.25939,32.271941 L 148.68982,28.514928 L 157.43866,27.909418 L 166.56487,21.653727 L 171.04786,19.783785 L 182.55285,23.894352 L 192.53652,27.711741 L 206.19942,33.92592 L 222.73864,43.897403 L 226.62772,46.72583 L 218.14244,56.625325 L 229.1026,65.46416 L 236.09558,57.164654 L 244.97593,63.390446 L 269.79497,85.090547 L 255.02353,111.69629 L 252.6264,115.70592 L 245.47042,112.72855 L 242.79704,114.64994 L 240.61821,116.15368 L 236.55354,115.32118 L 231.9912,113.95901 z',
    ],
    label: { x: 190, y: 68 },
  },
  {
    // Castello — east
    paths: [
      'M 269.70725,85.167359 L 290.57299,101.88045 L 297.25451,106.52453 L 322.4285,112.46905 L 337.79326,117.01736 L 346.46432,116.14246 L 355.48894,114.32071 L 364.13009,106.0691 L 377.78079,96.145801 L 389.1424,93.838709 L 394.27183,101.95214 L 395.2248,111.20433 L 395.05702,117.44289 L 389.1244,118.35378 L 371.69288,131.00942 L 366.3774,130.35659 L 336.87222,121.50033 L 334.43161,126.44312 L 326.97099,142.25723 L 326.60525,142.94634 L 325.77216,145.90684 L 342.02982,150.33525 L 347.82455,134.59923 L 356.07587,131.90868 L 367.46708,135.34204 L 371.35676,137.30168 L 367.0665,142.34722 L 364.44156,144.49872 L 363.81835,147.91438 L 367.14616,148.51959 L 370.61974,144.52862 L 370.76372,142.65288 L 374.41333,140.62183 L 380.29776,143.13299 L 384.24054,149.0955 L 384.04258,158.38949 L 379.67396,164.17811 L 371.86009,168.78013 L 369.33732,166.13718 L 367.89901,163.6983 L 366.91034,156.9506 L 366.90046,148.88911 L 363.64461,148.5016 L 363.69846,157.62171 L 364.98669,164.37493 L 368.39625,170.79898 L 370.18201,177.79805 L 370.60756,183.5089 L 370.9193,186.81658 L 370.75153,196.45308 L 368.61221,209.10292 L 366.03545,211.27242 L 362.6317,211.4042 L 353.23555,198.52041 L 347.20714,189.97533 L 333.42465,181.85551 L 322.24273,174.05933 L 312.34323,166.21527 L 299.89107,157.68208 L 288.55356,156.20779 L 279.55885,155.63247 L 267.80189,155.95002 L 260.90441,157.02868 L 255.66699,158.82635 L 252.79067,151.02408 L 252.79067,145.36723 L 247.48737,135.82128 L 243.95184,133.69996 L 235.82011,134.40707 L 234.05234,128.39666 L 237.58788,119.91138 L 239.7092,117.08295 L 245.28347,112.86298 L 248.72075,114.10393 L 252.6174,115.92459 L 269.70725,85.167359 z',
      // Murano-area Castello islands
      'M 297.03263,56.937231 C 294.06955,53.997569 293.28357,53.584911 292.6398,54.630882 C 290.24608,58.520031 290.50712,58.598282 282.93113,51.720274 C 278.05591,47.29422 275.87892,44.770384 276.38228,44.128026 C 276.79696,43.598806 281.32123,37.7737 286.43617,31.183346 L 295.73609,19.200884 L 298.23033,21.322508 C 299.60221,22.489415 304.81409,26.977855 309.81232,31.296833 L 318.90001,39.149526 L 309.92467,49.650319 C 304.98826,55.425752 300.88006,60.233533 300.79537,60.334281 C 300.71065,60.435012 299.01743,58.906344 297.03262,56.937222 L 297.03263,56.937231 z',
      // Lido approach
      'M 392.15178,231.66043 C 386.34005,229.67801 379.66952,225.78469 372.42679,220.14777 L 369.39362,217.78711 L 371.81546,206.48565 C 374.05522,196.03389 374.19839,194.28026 373.71986,183.1613 L 373.20241,171.1384 L 378.65913,168.08685 C 385.13579,164.46489 391.32569,163.84853 392.83835,166.67497 C 393.57439,168.05025 393.40802,168.35837 391.80665,168.58582 C 390.06544,168.83313 389.8739,169.38017 389.63008,174.80184 C 389.39602,180.00696 390.14745,187.9839 391.73016,197.09504 L 392.20963,199.85515 L 401.35301,199.85515 C 408.44444,199.85515 410.7337,199.56925 411.55368,198.58125 C 413.07686,196.74593 413.72415,196.97485 415.66098,200.03386 L 417.38729,202.76037 L 414.04585,204.75296 C 412.20805,205.84888 410.70441,206.9693 410.70441,207.24279 C 410.70441,207.51627 411.43387,210.26534 412.32543,213.35182 C 413.21697,216.43831 414.19293,221.10519 414.49419,223.72268 L 415.04191,228.48175 L 410.96234,230.20118 C 408.71854,231.14689 405.42244,232.18061 403.63767,232.49835 C 401.85287,232.8161 399.94205,233.23634 399.39135,233.43224 C 398.84062,233.62811 395.58283,232.83082 392.15176,231.66045 L 392.15178,231.66043 z',
      // Eastern Castello detail
      'M 355.33836,199.98829 C 347.65531,189.34403 347.28024,188.97425 339.78452,184.65401 C 335.55998,182.21915 328.10066,177.18708 323.20822,173.47162 C 318.31577,169.75615 311.06318,164.48072 307.09135,161.74844 C 300.04789,156.90314 299.66736,156.75676 291.65984,155.81237 C 278.40591,154.24925 266.14985,154.69218 258.09667,157.02531 C 256.53971,157.47639 256.01616,157.04519 254.91192,154.40238 C 254.1851,152.66287 253.59044,149.90666 253.59044,148.27748 C 253.59044,144.6411 249.06734,135.88148 246.22956,134.0221 C 244.71546,133.03003 243.16753,132.82127 240.40133,133.23609 C 236.84485,133.7694 236.58467,133.66921 235.73706,131.43984 C 234.43944,128.02683 237.00233,121.34464 241.16619,117.2846 C 244.88681,113.65672 245.55932,113.517 249.72928,115.50551 C 251.37412,116.28987 252.87292,116.76759 253.06002,116.56709 C 253.24711,116.3666 256.90617,109.89678 261.19128,102.18971 C 265.47638,94.482629 269.30902,87.845633 269.70826,87.440823 C 270.11464,87.02876 274.10987,89.668495 278.78528,93.43822 C 296.24439,107.51528 294.30255,106.53826 315.58676,111.95463 C 339.23547,117.97271 338.97366,117.93471 347.76996,116.62603 C 354.61462,115.60771 355.2197,115.34056 359.28227,111.54292 C 362.99941,108.0682 373.93523,99.664672 377.5055,97.539447 C 378.16348,97.147783 380.95638,96.356854 383.71198,95.781817 L 388.72217,94.736296 L 390.96082,98.250689 C 393.13692,101.66678 394.37977,106.97857 394.50639,113.40398 C 394.56404,116.33023 394.36522,116.58835 391.66319,117.09526 C 390.02482,117.40263 384.93723,120.40665 379.99582,123.98442 C 369.76877,131.38921 372.30917,131.2912 351.70132,125.07589 C 344.03788,122.76458 337.42168,120.87353 336.9987,120.87353 C 336.04536,120.87353 325.86718,142.08484 325.5697,144.69153 C 325.37384,146.40767 326.15966,146.81581 333.84596,148.99003 C 338.51691,150.31129 342.39575,151.40464 342.46559,151.4197 C 342.53543,151.43475 343.87303,147.81633 345.43802,143.37877 L 348.28346,135.31049 L 352.19078,134.01069 C 355.92287,132.76918 356.40845,132.80893 363.01889,134.89717 C 366.82533,136.09962 369.93971,137.26645 369.93971,137.49012 C 369.93971,137.71377 368.36852,139.6013 366.44819,141.68463 L 362.95665,145.47248 L 363.307,154.61692 C 363.60507,162.39726 363.9879,164.39994 365.87327,168.04187 C 368.64303,173.39207 369.93971,180.24675 369.93971,189.53807 C 369.93971,202.70993 367.63776,210.89559 363.9336,210.89559 C 363.53632,210.89559 359.66844,205.98731 355.33836,199.98829 L 355.33836,199.98829 z',
    ],
    label: { x: 330, y: 140 },
  },
  {
    // Santa Croce — west
    paths: [
      'M 110.28716,106.93937 C 110.27557,106.95803 109.3853,107.99418 109.3853,107.99418 L 95.81935,127.145 L 101.94832,144.86745 L 108.59804,144.696 L 111.72287,142.18525 L 113.84419,137.58905 L 124.80435,135.46773 L 127.98633,130.87154 L 127.95442,125.08974 L 133.16468,124.20054 L 135.41095,126.98245 L 139.05015,128.83262 L 142.93924,133.42881 L 146.3711,134.40707 L 146.3711,139.71037 L 149.19953,139.35682 L 153.79572,135.11418 L 155.20994,130.16443 L 153.44217,129.10377 L 148.13887,123.80047 L 144.95689,123.09336 L 143.18912,118.14361 L 146.72466,112.84031 L 149.90664,110.01189 L 155.91705,112.13321 L 161.92745,111.4261 L 163.34167,110.01189 L 170.05918,109.65833 L 176.06959,108.59767 L 179.60512,104.70859 L 183.49421,104.70859 L 196.07725,86.862807 L 189.50462,83.495383 L 183.42223,81.727616 L 177.19615,81.8594 L 170.41273,82.027179 L 165.93643,83.711056 L 158.30193,87.1926 L 149.24742,92.088356 L 143.60857,97.068002 L 138.88059,103.49176 L 134.68585,109.08272 L 130.66498,113.45715 L 126.96166,113.44525 L 125.42756,112.48066 L 123.39013,111.07255 L 120.53762,107.66299 L 115.58662,100.89243 C 115.59946,100.89104 110.29875,106.92071 110.28716,106.93937 z',
      // Santa Croce western detail
      'M 58.684191,166.53048 C 55.414522,164.63384 52.618717,162.98689 52.471293,162.87059 C 52.323861,162.7543 57.985943,153.40984 65.053676,142.10515 C 72.12141,130.80046 77.701317,121.34838 77.453476,121.10053 C 77.20561,120.85267 77.992216,118.96166 79.201458,116.89824 C 81.329444,113.26709 81.348952,113.10788 79.808674,111.94148 C 78.933413,111.27868 77.792859,110.72422 77.274128,110.70936 C 76.755381,110.69451 70.67045,120.14104 63.752034,131.70165 C 56.833601,143.26227 50.274933,154.15999 49.177174,155.9188 L 47.181274,159.11667 L 40.618395,154.74143 C 37.008807,152.33506 33.727512,150.07121 33.326625,149.71065 C 32.793524,149.23116 64.122262,97.094865 66.444169,94.597509 C 66.77793,94.23855 80.343549,92.532513 90.95625,91.514831 C 94.29116,91.19504 96.657644,90.46057 97.805103,89.389206 C 98.7694,88.488858 100.48916,87.751144 101.62679,87.749845 C 104.92398,87.746083 110.7224,91.2902 112.34327,94.299969 L 113.82907,97.058924 L 111.22872,99.836631 C 103.69474,107.88437 92.023487,124.68368 79.207717,145.92684 C 71.317471,159.00551 64.809479,169.76759 64.745453,169.84256 C 64.681418,169.91754 61.95386,168.42709 58.684191,166.53047 L 58.684191,166.53048 z',
      // Far west Santa Croce
      'M 28.710548,110.62036 L 23.365582,107.19697 L 25.892433,102.78249 C 27.282221,100.35453 32.227999,91.87114 36.883057,83.930515 L 45.346837,69.493015 L 50.691234,68.138259 L 56.035683,66.783521 L 67.551084,73.960156 C 73.884594,77.907292 80.499678,81.711327 82.251287,82.413541 C 85.575071,83.746054 86.39045,85.505705 84.092671,86.387446 C 83.353828,86.670973 78.780767,86.902941 73.93031,86.902941 C 67.413868,86.902941 64.3277,86.529265 62.110066,85.471752 C 56.909135,82.991602 54.789242,84.731991 43.891699,100.42855 C 38.679217,107.93652 34.333657,114.07139 34.234964,114.06158 C 34.136263,114.05178 31.650278,112.50323 28.710548,110.62036 z',
    ],
    label: { x: 105, y: 120 },
  },
];

/* Non-sestiere islands (lagoon context) */
const contextIslands = [
  // Train station causeway area
  'M 36.833319,7.703806 L 94.560615,56.11857 L 101.33628,63.581529 L 103.51329,73.446717 L 103.85629,80.888962 L 103.75922,86.907478 L 98.944407,86.666739 C 102.07403,67.166746 94.370334,62.111192 94.370334,62.111192 L 64.518494,35.870462 L 29.611099,7.4630654',
  // Grand Canal water path
  'M 109.63917,107.6909 L 110.49604,106.6731 L 108.12987,104.71281 L 114.9853,96.728329 L 111.4651,90.896201 L 103.70283,86.609579 L 98.611965,86.931606 L 95.998509,90.129519 L 91.587856,90.763471 L 89.852821,90.489725 C 89.856936,90.472985 83.092725,91.469595 83.108542,91.484115 C 83.124359,91.498635 82.167838,91.642672 82.171869,91.634373 C 82.127584,91.67439 65.953733,93.437195 65.953733,93.437195 L 31.260181,149.43159 L 47.506109,160.40927 L 77.019054,111.2303 L 80.255251,113.54673 L 75.660426,120.97204 L 76.723138,121.67163 L 50.911688,163.0449 L 65.062147,171.30243 C 65.075762,171.28933 88.680655,132.00065 88.583737,132.05549 L 91.638651,127.04825 L 91.632683,127.09742 L 94.398755,122.73981 L 107.3574,105.86918 L 109.63917,107.6909 z',
  // Small lagoon island
  'M 44.934115,68.42899 L 22.032211,107.46852 L 34.594436,115.48902 L 53.824305,87.75549 L 58.945827,85.04978 L 64.743777,87.562225 L 81.847731,87.75549 L 81.847731,91.620791 L 83.128111,91.475842 L 83.103953,87.562225 L 86.099561,86.98243 L 86.002928,83.213763 L 79.14202,80.02489 L 56.240117,65.916545 L 44.934115,68.42899 z',
  // Northern island
  'M 295.62952,17.814913 C 274.44434,44.777866 274.44434,45.259347 274.44434,45.259347 L 290.33322,59.703786 L 293.70359,54.888973 L 300.92581,61.629711 L 320.18506,39.00009 L 295.62952,17.814913 z',
  // Southern island
  'M 265.87186,198.85567 L 278.24013,225.48625 L 285.63486,223.29905 L 290.44092,204.85418 L 293.82638,197.26788 L 273.45845,187.69813 L 269.56327,188.66271 L 265.87186,198.85567 z',
  // Small south island
  'M 86.656286,202.40282 C 86.620581,202.30093 90.49196,198.23826 90.49196,198.23826 L 101.20654,196.97411 L 118.69757,199.54478 L 110.39806,223.05898 L 96.136335,228.55997 L 89.250753,231.49028 L 82.629029,231.85574 L 74.473498,226.30686 L 86.656286,202.40282 z',
  // Tiny island
  'M 77.946249,205.91046 L 69.883111,225.2462 L 54.255063,217.76759 L 58.974043,213.26429 L 67.138573,208.64719 L 76.332465,204.95852 C 76.258507,204.84163 77.937371,205.80401 77.946249,205.91046 z',
  // Eastern lagoon island
  'M 372.11784,170.446 C 372.18374,170.3087 373.12451,186.51149 373.12451,186.51149 L 372.87285,196.82434 L 370.38607,209.03064 L 368.22267,218.16352 L 377.15119,224.75534 L 384.46202,229.72309 L 392.02453,232.72539 L 398.47847,234.59504 L 409.07898,232.13817 L 415.82058,229.08797 L 414.82582,218.2297 L 411.44616,207.35343 L 418.7927,203.0629 L 413.61537,195.20084 L 410.25953,198.86815 L 395.49446,198.61648 L 392.75572,198.71838 L 390.93397,185.54053 L 390.01119,177.48078 L 390.77228,169.36735 L 392.8936,168.918 L 396.34526,173.84975 L 398.55046,173.41231 L 395.52436,168.49856 L 391.89884,164.16593 L 383.83301,164.3996 L 372.11784,170.446 z',
];

export default function SestiereSVGMap({ activeSestiere, onSelect }: SestiereSVGMapProps) {
  const [hovered, setHovered] = useState<number | null>(null);

  const getOpacity = (index: number) => {
    if (index === activeSestiere) return 0.7;
    if (index === hovered) return 0.5;
    return 0.3;
  };

  return (
    <div className="mb-8">
      <svg
        viewBox="0 0 462 273"
        className="w-full max-w-2xl mx-auto"
        role="img"
        aria-label="Interactive map of Venice's six sestieri districts"
      >
        {/* Water/lagoon background */}
        <rect x="0" y="0" width="462" height="273" rx="12" className="fill-sky-100/30 dark:fill-sky-900/20" />

        {/* Context islands (non-interactive, subtle) */}
        {contextIslands.map((d, i) => (
          <path
            key={`ctx-${i}`}
            d={d}
            fill="hsl(210 20% 85%)"
            fillOpacity={0.25}
            stroke="hsl(210 20% 60%)"
            strokeWidth="0.5"
            strokeOpacity={0.3}
          />
        ))}

        {/* Sestiere district polygons */}
        {sestiereData.map((sestiere, i) => (
          <g
            key={i}
            className="cursor-pointer"
            onClick={() => onSelect(i)}
            onMouseEnter={() => setHovered(i)}
            onMouseLeave={() => setHovered(null)}
          >
            {sestiere.paths.map((d, j) => (
              <path
                key={j}
                d={d}
                fill={sestiereColors[i].fill}
                fillOpacity={getOpacity(i)}
                stroke={i === activeSestiere ? sestiereColors[i].fill : 'hsl(0 0% 20%)'}
                strokeWidth={i === activeSestiere ? '2' : '0.85'}
                strokeOpacity={i === activeSestiere ? 0.8 : 0.5}
                style={{ transition: 'fill-opacity 300ms ease, stroke-width 300ms ease, stroke-opacity 300ms ease' }}
              />
            ))}
            <text
              x={sestiere.label.x}
              y={sestiere.label.y}
              textAnchor="middle"
              className={cn(
                'text-[8px] font-semibold pointer-events-none select-none',
                i === activeSestiere ? 'fill-foreground' : 'fill-foreground/60'
              )}
              style={{ transition: 'fill 300ms ease', textShadow: '0 1px 2px rgba(255,255,255,0.6)' }}
            >
              {sestiereColors[i].name}
            </text>
          </g>
        ))}

        {/* Compass rose */}
        <g transform="translate(440, 20)">
          <text textAnchor="middle" className="fill-muted-foreground/50 text-[8px] font-bold">N</text>
          <line x1="0" y1="4" x2="0" y2="14" className="stroke-muted-foreground/30" strokeWidth="1" />
        </g>
      </svg>
      <p className="text-center text-xs text-muted-foreground mt-2 italic">Click a district to explore</p>
    </div>
  );
}
